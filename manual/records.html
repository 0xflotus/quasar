<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/Organization">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta itemprop="name" content="Quasar">
<meta itemprop="description" content="Lightweight threads, CSP and actors for the JVM">
<title>
  
    Records - 
   Quasar
</title>
<!--<link rel="shortcut icon" href="/images/icons/loading_icon.png">-->
<link href="/quasar/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="/quasar/css/pygments/jekyll-github.css"  rel="stylesheet" type="text/css">
<!-- comment out the next line to disable line numbers -->
<link href="/quasar/css/pygments/linenos.css"        rel="stylesheet" type="text/css">
<!-- <link href="/quasar/css/prettify/sunburst.css" rel="stylesheet" type="text/css"> -->
<link href="/quasar/css/site.css?now" rel="stylesheet" type="text/css">



</head>
<body>

<div class="navbar navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container-fluid">
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
      </a>
      <a class="brand" href="/quasar/">Quasar</a>
      <div class="nav-collapse collapse">
        <ul class="nav">
          <li class="icon github"><a href="https://github.com/puniverse/quasar"><img src="/quasar/images/icons/github.png">View on Github</a></li>
          <li><a href="/quasar/javadoc/index.html">API</a> </li>
          <li class="icon bug"><a href="https://github.com/puniverse/quasar/issues/new"><img src="/quasar/images/icons/bug.png">File a bug</a></li>
          <!-- <li class="icon source"><a href="https://github.com/puniverse/pulsar/blob/master/CONTRIBUTING.md"><img src="/images/icons/source.png">Contribute</a> </li> -->
          <li class="icon talk"><a href="https://groups.google.com/forum/#!forum/quasar-pulsar-user"><img src="/quasar/images/icons/talk.png">Discuss</a></li>
        </ul>
      </div>
    </div>
  </div>
</div>


<div class="container-fluid">
  <div class="row-fluid">
    <div class="span3">
  <div class="well well-small sidebar-nav">
    <ul class="nav nav-list">
      
        <li class="nav-header">Getting Started</li>
        
          
          
            
          
          
          
        
          
          
            
          
          
          
            <li>
              <a  href="/quasar/getting-started.html">
                Getting Started
              </a>
              
            </li>
          
        
          
          
            
          
          
          
        
          
          
            
          
          
          
        
          
          
            
          
          
          
        
          
          
            
          
          
          
        
          
          
            
          
          
          
            <li>
              <a  href="/quasar/news.html">
                News
              </a>
              
            </li>
          
        
      
        <li class="nav-header">User Manual</li>
        
          
          
            
          
          
          
            <li>
              <a  href="/quasar/manual/core.html">
                Quasar Core
              </a>
              
            </li>
          
        
          
          
            
          
          
          
        
          
          
            
          
          
          
            <li>
              <a  href="/quasar/manual/actors.html">
                Quasar's Actor System
              </a>
              
            </li>
          
        
          
          
            
          
          
          
            <li>
              <a class="active" href="/quasar/manual/records.html">
                Records
              </a>
              
              <ul class="nav nav-list"></ul>
              
            </li>
          
        
          
          
            
          
          
          
            <li>
              <a  href="/quasar/manual/cluster.html">
                Clustering
              </a>
              
            </li>
          
        
          
          
            
          
          
          
            <li>
              <a  href="/quasar/manual/examples.html">
                Examples
              </a>
              
            </li>
          
        
          
          
            
          
          
          
        
      
      <li class="divider"></li>
    </ul>
  </div>
</div>

    <div class="span8" id="content-container">

      <span class="edit-on-github">
  <a href="https://github.com/puniverse/quasar/edit/master/docs/manual/records.md">Edit on Github</a>
</span>


      
      <div class="page-header">
        <h1>Records
          
        </h1>
      </div>
      

      <div id="content">
<p>Just as actors expose their operations through a simple, standard interface that allows (pretty-much) only to send it messages, so should state be exposed through a simple, standard, interface. A record, then, is such a data-access interface akin to a map. It basically has get(field) and set(field, value) methods, only it preserves the type information of its field to provide type&nbsp;safety.</p>

<p>Records provide similar functionality to plain Java objects with public fields, but, unlike plain objects, they allow us to inject cross-cutting concerns on field-get and field-set operations, like restricting access to specific strands, or making sure that state is mutated (or read) only inside&nbsp;transactions.</p>

<p>Just as objects are instances of a classe, so too are records instances of a <em>record type</em>, represented by the <a href="/quasar/javadoc/co/paralleluniverse/data/record/RecordType.html"><code>RecordType</code></a> class. A new record type must be declared as a static member of a class. The class must only include the definition of a single record type, and this class is called the type’s <em>identifier class</em>, because it is used only to uniquely identify the record type (only its name is used&nbsp;internally).</p>

<p>Here’s an example record type&nbsp;definition:</p>

<div class="highlight"><pre><code><span id="line-1"><span class="kd">class</span> <span class="nc">A</span> <span class="o">{</span>
</span><span id="line-2">	<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">RecordType</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="n">aType</span> <span class="o">=</span> <span class="n">RecordType</span><span class="o">.</span><span class="na">newType</span><span class="o">(</span><span class="n">A</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span><span id="line-3">	<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">IntField</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="n">$id</span> <span class="o">=</span> <span class="n">stateType</span><span class="o">.</span><span class="na">intField</span><span class="o">(</span><span class="s">&quot;id&quot;</span><span class="o">);</span>
</span><span id="line-4">	<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">DoubleField</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="n">$foo</span> <span class="o">=</span> <span class="n">stateType</span><span class="o">.</span><span class="na">doubleField</span><span class="o">(</span><span class="s">&quot;id&quot;</span><span class="o">,</span> <span class="n">Field</span><span class="o">.</span><span class="na">TRANSIENT</span><span class="o">);</span>
</span><span id="line-5">	<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">ObjectField</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">$name</span> <span class="o">=</span> <span class="n">stateType</span><span class="o">.</span><span class="na">objectField</span><span class="o">(</span><span class="s">&quot;name&quot;</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span><span id="line-6">	<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">ObjectField</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">$emails</span> <span class="o">=</span> <span class="n">stateType</span><span class="o">.</span><span class="na">objectField</span><span class="o">(</span><span class="s">&quot;emails&quot;</span><span class="o">,</span> <span class="k">new</span> <span class="n">TypeToken</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;()</span> <span class="o">{});</span>
</span><span id="line-7"><span class="o">}</span>
</span></code></pre></div>
<p><code>A</code> is the type’s identifier class. The fields are instances of <a href="/quasar/javadoc/co/paralleluniverse/data/record/Field.html"><code>Field</code></a> and are, by convention, given identifiers that begin with a <code>$</code> to make it clear that they identify fields rather than&nbsp;values.</p>

<p>Record types, like classes, can extend a parent record type by providing the super-type to <code>RecordType.newType</code> or to <code>RecordType</code>’s&nbsp;constructor.</p>

<p>A new record is instantiated by calling one of <code>RecordType</code>’s <code>newInstance</code> methods. Please consult the <a href="/quasar/javadoc/co/paralleluniverse/data/record/RecordType.html">Javadoc</a> for&nbsp;details.</p>

<p>So, instead of writing <code>obj.getX()</code>, or <code>obj.x</code> we write <code>obj.get($x)</code>. What does this get us other than re-inventing what is a basic Java functionality, minus the some type safety? Like actors, records give up some type safety (we preserve the type of the <code>x</code> field, but the compiler can’t tell us whether obj even has an <code>x</code> field; similarly, if we send message <code>m</code> to actor <code>a</code>, the compiler can’t know whether <code>a</code> supports an <code>m</code> operation), they do so at well-defined interface points between separate software components. What we gain is loose coupling. For example, among other things, we gain the ability to swap the implementation of the record or actor at runtime for maintenance (hot&nbsp;code-swapping).</p>

<p>We gain other things by limiting component interaction to the narrow interfaces of actors and records, and that is the ability to insert cross-cutting concerns. For example, what happens if a method that consumes a resource is called too often? We need to explicitely insert load-handling code into the method. But if we communicate with the component through an actor interface, we can implement a general policy of handling too many messages that are thrown at any actor. Similarly with records. Parallel Universe’s database, SpaceBase, uses records to restrict read and writes of shared state to well-defined transactions. Attempts to read or write state outside a transaction will throw a runtime&nbsp;exception.</p>

<p>Because records are intended to control mutability, an <code>ObjectField</code> should never reference a mutable object. <code>RecordType</code> will perform a very simple test on an <code>ObjectField</code> type and output a warning to the console if the class appears mutable. Conclusively determining whether a class is mutable or not is extremely difficult, so the test is a very simple one: it will warn if the class has public non-static, non-final fields, or if it has public methods whose name begins with&nbsp;“set”.</p>

</div>

      <hr>

      <footer>
        <div>
          <div>&copy; 2013-2014, Parallel Universe Software Co.</div>
        </div>
      </footer>

    </div>
  </div>
</div>

<!-- <script src="/quasar/js/prettify/prettify.js"></script> -->
<script src="/quasar/js/jquery.min.js"></script>
<script src="/quasar/bootstrap/js/bootstrap.min.js"></script>
<script src="/quasar/js/bootstrap-scrollspy.js"></script>
<script>


  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-25007319-2']);
  _gaq.push(['_trackPageview']);
  
  (function() {
    var ga = document.createElement('script'); 
    ga.type = 'text/javascript'; 
    ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; 
    s.parentNode.insertBefore(ga, s);
  })();


// Change "active" style on selected left-hand navigation menu item.
$(document).ready(function () {
  var path = location.pathname;
  $('ul.nav > li > a[href="' + path + '"]').parent().addClass('active');

  // TODO: Use kramdown {:.prettyprint .linenums .lang-ruby} to add the
  // <pre class="prettyprint"> instead of doing this client-side.

  // $('pre:has(code:not(.language-txt))').addClass('prettyprint');
  // window.prettyPrint && prettyPrint();
});
</script>

</body>
</html>
