<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/Organization">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta itemprop="name" content="Quasar">
<meta itemprop="description" content="Lightweight threads, CSP and actors for the JVM">
<title>
  
    Quasar's Actor System - 
   Quasar
</title>
<!--<link rel="shortcut icon" href="/images/icons/loading_icon.png">-->
<link href="/quasar/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="/quasar/css/pygments/jekyll-github.css"  rel="stylesheet" type="text/css">
<!-- comment out the next line to disable line numbers -->
<link href="/quasar/css/pygments/linenos.css"        rel="stylesheet" type="text/css">
<!-- <link href="/quasar/css/prettify/sunburst.css" rel="stylesheet" type="text/css"> -->
<link href="/quasar/css/site.css?now" rel="stylesheet" type="text/css">



</head>
<body>

<div class="navbar navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container-fluid">
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
      </a>
      <a class="brand" href="/quasar/">Quasar</a>
      <div class="nav-collapse collapse">
        <ul class="nav">
          <li class="icon github"><a href="https://github.com/puniverse/quasar"><img src="/quasar/images/icons/github.png">View on Github</a></li>
          <li><a href="/quasar/javadoc/index.html">API</a> </li>
          <li class="icon bug"><a href="https://github.com/puniverse/quasar/issues/new"><img src="/quasar/images/icons/bug.png">File a bug</a></li>
          <!-- <li class="icon source"><a href="https://github.com/puniverse/pulsar/blob/master/CONTRIBUTING.md"><img src="/images/icons/source.png">Contribute</a> </li> -->
          <li class="icon talk"><a href="https://groups.google.com/forum/#!forum/quasar-pulsar-user"><img src="/quasar/images/icons/talk.png">Discuss</a></li>
        </ul>
      </div>
    </div>
  </div>
</div>


<div class="container-fluid">
  <div class="row-fluid">
    <div class="span3">
  <div class="well well-small sidebar-nav">
    <ul class="nav nav-list">
      
        <li class="nav-header">Getting Started</li>
        
          
          
            
          
          
          
        
          
          
            
          
          
          
            <li>
              <a  href="/quasar/getting-started.html">
                Getting Started
              </a>
              
            </li>
          
        
          
          
            
          
          
          
        
          
          
            
          
          
          
        
          
          
            
          
          
          
        
          
          
            
          
          
          
            <li>
              <a  href="/quasar/news.html">
                News
              </a>
              
            </li>
          
        
      
        <li class="nav-header">User Manual</li>
        
          
          
            
          
          
          
            <li>
              <a  href="/quasar/manual/core.html">
                Quasar Core
              </a>
              
            </li>
          
        
          
          
            
          
          
          
        
          
          
            
          
          
          
            <li>
              <a class="active" href="/quasar/manual/actors.html">
                Quasar's Actor System
              </a>
              
              <ul class="nav nav-list"><li></li></ul>
              
            </li>
          
        
          
          
            
          
          
          
            <li>
              <a  href="/quasar/manual/cluster.html">
                Clustering
              </a>
              
            </li>
          
        
          
          
            
          
          
          
            <li>
              <a  href="/quasar/manual/examples.html">
                Examples
              </a>
              
            </li>
          
        
          
          
            
          
          
          
        
      
      <li class="divider"></li>
    </ul>
  </div>
</div>

    <div class="span8" id="content-container">

      <span class="edit-on-github">
  <a href="https://github.com/puniverse/quasar/edit/master/docs/manual/actors.md">Edit on Github</a>
</span>


      
      <div class="page-header">
        <h1>Quasar's Actor System
          
        </h1>
      </div>
      

      <div id="content">
<p>To use the terms we’ve learned so far, an <em>actor</em> is a strand that owns a single channel with some added lifecyce management and error handling. But this reductionist view of actors does them little justice. Actors are fundamental building blocks that are combined to build a fault-tolerant application. If you are familiar with Erlang, Quasar actors are just like Erlang&nbsp;processes.</p>

<p>An actor is a self-contained execution unit with well-defined inputs and outputs. Actors communicate with other actors (as well as regular program threads and fibers) by passing&nbsp;messages.</p>

<p class="alert alert-info"><strong>Note</strong>: Actors may write to and read from channels other than their own mailbox. In fact, actors can do whatever regular fibers&nbsp;can.</p>

<h3 id="creating-actors">Creating&nbsp;Actors</h3>

<p>All actors extends the <a href="/quasar/javadoc/co/paralleluniverse/actors/Actor.html"><code>Actor</code></a> class. The constructor takes the actor’s name (which does not have to be unique, and may even be <code>null</code>), and its mailbox settings (of type <a href="/quasar/javadoc/co/paralleluniverse/actors/MailboxConfig.html"><code>MailboxConfig</code></a>).</p>

<p><code>MailboxConfig</code> defines the mailbox size (the number of messages that can wait in the mailbox channel), with <code>-1</code> specifying an unbounded mailbox, and an <em>overflow policy</em>. The overflow policy works the same as for plain channels, except that the <code>THROW</code> policy doesn’t cause an exception to be thrown in the sender if the mailbox capacity is exceeded, but rather throws an exception into the receiving actor (the exception will be thrown when the actor next blocks on a&nbsp;<code>recieve</code>).</p>

<p>An actor is required to implement the <a href="/quasar/javadoc/co/paralleluniverse/actors/Actor.html#doRun()"><code>doRun</code></a> method. This method is the actor body, and is run when the actor is&nbsp;spawned.</p>

<p>It is prefereable to subclass <a href="/quasar/javadoc/co/paralleluniverse/actors/BasicActor.html"><code>BasicActor</code></a> rather than <code>Actor</code>; <code>BasicActor</code> provides the ability to perform selective receives (more on that&nbsp;later).</p>

<h3 id="spawning-actors">Spawning&nbsp;Actors</h3>

<p>Actors can run in any strand – fiber or thread, although you’d usually want to run them in fibers. <code>Actor</code> implements <code>SuspendableCallable</code> so you may run it by setting it as the target of a fiber or a thread (via <code>Strand.toRunnable(SuspendableCallable))</code>). A simpler way to start an actor is by&nbsp;calling</p>

<div class="highlight"><pre><code><span id="line-1"><span class="n">actor</span><span class="o">.</span><span class="na">spawn</span><span class="o">()</span>
</span></code></pre></div>
<p>which assigns the actor to a newly created fiber and starts it,&nbsp;or</p>

<div class="highlight"><pre><code><span id="line-1"><span class="n">actor</span><span class="o">.</span><span class="na">spawnThread</span><span class="o">()</span>
</span></code></pre></div>
<p>which assigns the actor to a newly created thread and&nbsp;starts.</p>

<p>An actor can be <code>join</code>ed, just like a fiber. Calling <code>get</code> on an actor will join it and return the value returned by&nbsp;<code>doRun</code>.</p>

<p class="alert alert-info"><strong>Note</strong>: Just like fibers, spawning an actor is a very cheap operation in both computation and memory. Do not fear creating many (thousands, tens-of-thousands or even hundereds-of-thousands)&nbsp;actors.</p>

<h2 id="sending-and-receiving-messages-actorref">Sending and Receiving Messages,&nbsp;<code>ActorRef</code></h2>

<p>The <code>spawn</code> method returns an instance of <a href="/quasar/javadoc/co/paralleluniverse/actors/ActorRef.html"><code>ActorRef</code></a>. All (almost) interactions with an actor take place through its <code>ActorRef</code>, which can also be obtained by calling <code>ref()</code> on the actor. The <code>ActorRef</code> is used as a level of indirection that provides additional isolation for the actor (and actors are all about isolation). It enables things like hot code swapping and&nbsp;more.</p>

<p><a href="/quasar/javadoc/co/paralleluniverse/actors/ActorRef.html#self()"><code>ActorRef.self()</code></a> is a static function that returns the currently executing actor’s ref, and <a href="/quasar/javadoc/co/paralleluniverse/actors/Actor.html#self()"><code>Actor.self()</code></a> is a protected member function that returns an actor’s ref. Use them to obtain and share an actor’s ref with other&nbsp;actors.</p>

<p class="alert alert-warn"><strong>Note</strong>: An actor must <em>never</em> pass a direct reference to itself to other actors or to be used on other strands. However, it may share its <code>ActorRef</code>&nbsp;freely.</p>

<p>The <code>ActorRef</code> allows sending messages to the actor’s mailbox. In fact, <code>ActorRef</code> implements <code>SendPort</code> so it can be used just like a&nbsp;channel.</p>

<p>An actor receives a message by calling the <a href="/quasar/javadoc/co/paralleluniverse/actors//Actor.html#receive()"><code>recieve</code></a> method. The method blocks until a message is available in the mailbox, and then returns it. <a href="/quasar/javadoc/co/paralleluniverse/actors//Actor.html#receive(long, java.util.concurrent.TimeUnit)">Another version</a> of <code>receive</code> blocks up to a given duration, and returns <code>null</code> if no message is received by that&nbsp;time.</p>

<p>Normally, an actor is implements a loop similar to this&nbsp;one:</p>

<div class="highlight"><pre><code><span id="line-1"><span class="nd">@Override</span>
</span><span id="line-2"><span class="kd">protected</span> <span class="n">Void</span> <span class="nf">doRun</span><span class="o">()</span> <span class="o">{</span>
</span><span id="line-3">    <span class="k">for</span><span class="o">(;;)</span> <span class="o">{</span>
</span><span id="line-4">        <span class="n">Object</span> <span class="n">msg</span> <span class="o">=</span> <span class="n">receive</span><span class="o">();</span>
</span><span id="line-5">        <span class="c1">// process message</span>
</span><span id="line-6">        <span class="k">if</span> <span class="o">(</span><span class="n">thatsIt</span><span class="o">())</span>
</span><span id="line-7">            <span class="k">break</span><span class="o">;</span>
</span><span id="line-8">    <span class="o">}</span>
</span><span id="line-9">    <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
</span><span id="line-10"><span class="o">}</span>
</span></code></pre></div>
<h3 id="selective-receive">Selective&nbsp;Receive</h3>

<p>If your actor extends <a href="/quasar/javadoc/co/paralleluniverse/actors/BasicActor.html"><code>BasicActor</code></a>, there’s another form of the <code>receive</code>&nbsp;method</p>

</div>

      <hr>

      <footer>
        <div>
          <div>&copy; 2013, Parallel Universe Software Co.</div>
        </div>
      </footer>

    </div>
  </div>
</div>

<!-- <script src="/quasar/js/prettify/prettify.js"></script> -->
<script src="/quasar/js/jquery.min.js"></script>
<script src="/quasar/bootstrap/js/bootstrap.min.js"></script>
<script src="/quasar/js/bootstrap-scrollspy.js"></script>
<script>


  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-25007319-2']);
  _gaq.push(['_trackPageview']);
  
  (function() {
    var ga = document.createElement('script'); 
    ga.type = 'text/javascript'; 
    ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; 
    s.parentNode.insertBefore(ga, s);
  })();


// Change "active" style on selected left-hand navigation menu item.
$(document).ready(function () {
  var path = location.pathname;
  $('ul.nav > li > a[href="' + path + '"]').parent().addClass('active');

  // TODO: Use kramdown {:.prettyprint .linenums .lang-ruby} to add the
  // <pre class="prettyprint"> instead of doing this client-side.

  // $('pre:has(code:not(.language-txt))').addClass('prettyprint');
  // window.prettyPrint && prettyPrint();
});
</script>

</body>
</html>
